<%- include ('../nav/header')  %>        
<!-- Sidebar Page -->
<%- include('../nav/sidebar') %>

  <!--Upload Excel-->
  <a href="/workorder_excell_download">Download Template</a></p>
  <div class="card" id="table">
    <div class="card-body">
      <section id="upload-data-panel">
      <form id="upload-form" action="/uploads/Contractor_csv" method="post" enctype="multipart/form-data">
        
        <fieldset>
        <legend>Upload Data</legend>
        <div>
          <!-- The name here is important, and will be used later to reference the data -->
          <input type="file" name="csvdata" accept="text/cvs">
        </div>
        <div>
          <input type="submit" value="Submit" />
        </div>
        </fieldset>
      </form>
      </section>
    </div>
  </div>
  <br/>

 <a href="/workordernew/add" class="btn btn-gradient-primary btn-rounded btn-fw f-r m-b-20" id="addbutton">New</a>
 <br/>
<div class="col-lg-12 grid-margin stretch-card">
    <div class="card overflow-x overflow-y-hidden" id="table">
        <div class="card-body">
            <h4 class="card-title">Work Order</h4>
            <div class="form-group">
             <!--Search Filter-->
					  <input type="search" placeholder="Search Here" class="form-control search-input" data-table="customers-list"/>
            </div>
            <table class="table table-striped mt32 customers-list">
                <thead>
                <tr>
                <th>CCODE</th>
                <th>WORK_ORDER</th>
                <th>WORK_OR_DATE</th>
                <th>DURATION</th>
                <th>Action</th>
                </tr>
                </thead>
                <tbody>

                <% data.forEach(function(work_order){ %>
                <tr>
                <td class="py-1"><%= work_order.CCODE   %> </td>
                <td> <%= work_order.WORK_ORDER  %> </td>
                <td>
                  <label class="badge badge-gradient-info">
                    <%= moment(work_order.WORK_OR_DATE).format('YYYY-MM-DD'); %>
                  </label>
                </td>
                <td> <%= work_order.DURATION   %></td>
                <td>
                  <a href="work_edit/<%= work_order.id %>/<%= work_order.WORK_ORDER %>" class="btn btn-sm btn-primary">Edit</a>
                </td>
                </tr>
                        
                <% }) %>
                </tbody>
				</table>
        <br/><br/>
        </div>
    </div>
</div>

<!-- Footer Page-->
<%- include('../nav/footer') %>



<script type="text/javascript">
  window.onload = function() {

    document.getElementById("newform").style.display = "none";

  };

  function addWorkOrder(a) {
  
    if (a == 1) {
      //document.getElementById("newform").style.display = "block";
	  //document.getElementById("table").style.display = "none";
      //document.getElementById("addbutton").style.display = "none";
      $.ajax({
			url: '/workordernew/add',
			type: 'GET',
			//data: { "id": data }
			}).done(function(response){
			//callback to handle if it's successful
		})
    } else {
      document.getElementById("newform").style.display = "none";
    } 
  }
</script> 

  <!--Table Sort-->
  <script>
    (function(document) {
      'use strict';
  
      var TableFilter = (function(myArray) {
        var search_input;
  
        function _onInputSearch(e) {
          search_input = e.target;
          var tables = document.getElementsByClassName(search_input.getAttribute('data-table'));
          myArray.forEach.call(tables, function(table) {
            myArray.forEach.call(table.tBodies, function(tbody) {
              myArray.forEach.call(tbody.rows, function(row) {
                var text_content = row.textContent.toLowerCase();
                var search_val = search_input.value.toLowerCase();
                row.style.display = text_content.indexOf(search_val) > -1 ? '' : 'none';
              });
            });
          });
        }
  
        return {
          init: function() {
            var inputs = document.getElementsByClassName('search-input');
            myArray.forEach.call(inputs, function(input) {
              input.oninput = _onInputSearch;
            });
          }
        };
      })(Array.prototype);
  
      document.addEventListener('readystatechange', function() {
        if (document.readyState === 'complete') {
          TableFilter.init();
        }
      });
  
    })(document);
  </script>